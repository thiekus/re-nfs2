#include "hookinit.h"

int doRegisterCRTHook(void* hookMgr, func_AddHookCallback cbAddHook)
{
    // Functions that exists on clbr20.dll
    ADD_FUNC_HOOK("sprintf_", 0x00480dee);
    ADD_FUNC_HOOK("strcpy_", 0x00480f2b);
    ADD_FUNC_HOOK("strcat_", 0x00483ac2);
    ADD_FUNC_HOOK("memcpy_", 0x0048521d);
    ADD_FUNC_HOOK("rand_", 0x0048561c);
    ADD_FUNC_HOOK("srand_", 0x00485640);
    ADD_FUNC_HOOK("strncmp_", 0x00486193);
    ADD_FUNC_HOOK("__assert_", 0x004861bc);
    ADD_FUNC_HOOK("strncpy_", 0x004861db);
    ADD_FUNC_HOOK("stricmp_", 0x00486361);
    ADD_FUNC_HOOK("strlen_", 0x004863a8);
    ADD_FUNC_HOOK("exit_", 0x0048835b);
    ADD_FUNC_HOOK("_exit_", 0x00488373);
    ADD_FUNC_HOOK("strcmp_", 0x004883a0);
    ADD_FUNC_HOOK("atoi_", 0x00488570);
    ADD_FUNC_HOOK("toupper_", 0x0048a3b4);
    ADD_FUNC_HOOK("_nmalloc_", 0x0048a46e);
    ADD_FUNC_HOOK("_nfree_", 0x0048a55d);
    ADD_FUNC_HOOK("strstr_", 0x0048ac21);
    ADD_FUNC_HOOK("strchr_", 0x0048acdf);
    ADD_FUNC_HOOK("strrchr_", 0x0048acf3);
    ADD_FUNC_HOOK("unlink_", 0x0048c7ec);
    ADD_FUNC_HOOK("_fsopen_", 0x0048fac7);
    ADD_FUNC_HOOK("fopen_", 0x0048fb00);
    ADD_FUNC_HOOK("freopen_", 0x0048fb84);
    ADD_FUNC_HOOK("fwrite_", 0x0048fbec);
    ADD_FUNC_HOOK("fclose_", 0x0048fdd2);
    ADD_FUNC_HOOK("fprintf_", 0x0049beeb);
    ADD_FUNC_HOOK("fgets_", 0x0049cc54);
    ADD_FUNC_HOOK("getcwd_", 0x0049df77);
    ADD_FUNC_HOOK("_dos_getdiskfree_", 0x0049dff0);
    ADD_FUNC_HOOK("chdir_", 0x0049e6e2);
    ADD_FUNC_HOOK("time_", 0x0049e888);
    ADD_FUNC_HOOK("_fpreset_", 0x004a1027);
    ADD_FUNC_HOOK("vsprintf_", 0x004a1318);
    ADD_FUNC_HOOK("printf_", 0x004a132d);
    ADD_FUNC_HOOK("__STOSB", 0x004a1ad0);
    ADD_FUNC_HOOK("__STOSD", 0x004a1b07);
    ADD_FUNC_HOOK("__threadid_", 0x004a51f8);
    ADD_FUNC_HOOK("abort_", 0x004a53a0);
    ADD_FUNC_HOOK("bsearch_", 0x004a9449);
    ADD_FUNC_HOOK("qsort_", 0x004a9532);
    ADD_FUNC_HOOK("__nmemneed_", 0x004a9e40);
    ADD_FUNC_HOOK("__set_EDOM_", 0x004b1317);
    ADD_FUNC_HOOK("__set_ERANGE_", 0x004b132a);
    ADD_FUNC_HOOK("open_", 0x004b134f);
    ADD_FUNC_HOOK("sopen_", 0x004b1373);
    ADD_FUNC_HOOK("fseek_", 0x004b167b);
    ADD_FUNC_HOOK("fputc_", 0x004b19a7);
    ADD_FUNC_HOOK("getpid_", 0x004b1a6a);
    ADD_FUNC_HOOK("ftell_", 0x004b1a74);
    ADD_FUNC_HOOK("lseek_", 0x004b1ac5);
    ADD_FUNC_HOOK("remove_", 0x004b1b6e);
    ADD_FUNC_HOOK("fgetc_", 0x004bb643);
    ADD_FUNC_HOOK("ungetc_", 0x004bb7bc);
    ADD_FUNC_HOOK("strncat_", 0x004bc488);
    ADD_FUNC_HOOK("mktime_", 0x004bc52c);
    ADD_FUNC_HOOK("utoa_", 0x004bc706);
    ADD_FUNC_HOOK("itoa_", 0x004bc750);
    ADD_FUNC_HOOK("ultoa_", 0x004bc7a2);
    ADD_FUNC_HOOK("ltoa_", 0x004bc7ec);
    ADD_FUNC_HOOK("memset_", 0x004bc950);
    ADD_FUNC_HOOK("raise_", 0x004bca93);
    ADD_FUNC_HOOK("__sigfpe_handler_", 0x004bcacc);
    ADD_FUNC_HOOK("signal_", 0x004bcb13);
    ADD_FUNC_HOOK("__CloseSemaphore_", 0x004bd253);
    ADD_FUNC_HOOK("__AccessSemaphore_", 0x004bd306);
    ADD_FUNC_HOOK("__ReleaseSemaphore_", 0x004bd368);
    ADD_FUNC_HOOK("__MultipleThread_", 0x004bd38d);
    ADD_FUNC_HOOK("strdup_", 0x004bd680);
    ADD_FUNC_HOOK("memmove_", 0x004bdbf0);
    ADD_FUNC_HOOK("fflush_", 0x004bdc3d);
    ADD_FUNC_HOOK("_nheapshrink_", 0x004bdc4d);
    ADD_FUNC_HOOK("isatty_", 0x004c1265);
    ADD_FUNC_HOOK("tell_", 0x004c1310);
    ADD_FUNC_HOOK("fcloseall_", 0x004c13d0);
    ADD_FUNC_HOOK("flushall_", 0x004c1d34);
    ADD_FUNC_HOOK("getche_", 0x004c1d74);
    ADD_FUNC_HOOK("__FDFS", 0x004c1e0a);
    ADD_FUNC_HOOK("_gmtime_", 0x004c23b2);
    ADD_FUNC_HOOK("gmtime_", 0x004c23d0);
    ADD_FUNC_HOOK("tzset_", 0x004c2531);
    ADD_FUNC_HOOK("_control87_", 0x004c2b39);
    ADD_FUNC_HOOK("_nrealloc_", 0x004c2c37);
    ADD_FUNC_HOOK("calloc_", 0x004c2dbc);
    ADD_FUNC_HOOK("__EnterWVIDEO_", 0x004c2dd9);
    ADD_FUNC_HOOK("stackavail_", 0x004c2dff);
    ADD_FUNC_HOOK("fread_", 0x004c2e39);
    ADD_FUNC_HOOK("getch_", 0x004c886c);
    ADD_FUNC_HOOK("putch_", 0x004c88e2);
    ADD_FUNC_HOOK("getenv_", 0x004c8944);
    ADD_FUNC_HOOK("_nmsize_", 0x004c89f2);
    ADD_FUNC_HOOK("_nexpand_", 0x004c89fb);
    ADD_FUNC_HOOK("_beginthread_", 0x004c8bd6);
    ADD_FUNC_HOOK("_endthread_", 0x004c8bdd);
    ADD_FUNC_HOOK("__RegisterThreadData_", 0x004c8beb);
    ADD_FUNC_HOOK("strnicmp_", 0x004cb1a6);
    ADD_FUNC_HOOK("__CmpBigInt", 0x004cb3fa);
    ADD_FUNC_HOOK("__Rnd2Int", 0x004cb434);
    ADD_FUNC_HOOK("__Bin2String", 0x004cb49f);
    ADD_FUNC_HOOK("__fdiv_fpr", 0x004cb6d7);
    ADD_FUNC_HOOK("__fdiv_chk", 0x004cbb99);
    ADD_FUNC_HOOK("__fdiv_m32", 0x004cbbac);
    ADD_FUNC_HOOK("__fdiv_m64", 0x004cbbf8);
    ADD_FUNC_HOOK("__fdiv_m32r", 0x004cbc44);
    ADD_FUNC_HOOK("__fdiv_m64r", 0x004cbc90);
    // ADD_FUNC_HOOK("verify_pentium_fdiv_bug_", 0x004cbee8);
    ADD_FUNC_HOOK("__get_std_stream_", 0x004cbfbf);
    ADD_FUNC_HOOK("fputs_", 0x004cbfde);

    // Functions that exists on mthr20.dll
    ADD_FUNC_HOOK("strtod_", 0x004c856e);
    ADD_FUNC_HOOK("IF@LOG", 0x004cac94);
    ADD_FUNC_HOOK("IF@LOG2", 0x004cacd7);
    ADD_FUNC_HOOK("IF@LOG10", 0x004cacdb);
    ADD_FUNC_HOOK("log_", 0x004cacdf);
    ADD_FUNC_HOOK("log10_", 0x004caceb);
    ADD_FUNC_HOOK("log2_", 0x004cacf7);
    ADD_FUNC_HOOK("floor_", 0x004cad03);
    // ADD_FUNC_HOOK("__ModF", 0x004cb07a);
    // ADD_FUNC_HOOK("__ZBuf2F", 0x004cb10a);
    // ADD_FUNC_HOOK("__log87_err_", 0x004cb3a3);
    ADD_FUNC_HOOK("modf_", 0x004cb3e0);
    ADD_FUNC_HOOK("frexp_", 0x004cbcdc);
    ADD_FUNC_HOOK("__math1err_", 0x004cbe03);
    ADD_FUNC_HOOK("__math2err_", 0x004cbe0d);
    ADD_FUNC_HOOK("_set_matherr_", 0x004cbf3d);
    ADD_FUNC_HOOK("_matherr_", 0x004cbf8b);

    return 1;
}
